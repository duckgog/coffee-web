<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coffee Shop</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è */
        
        /* –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü */
        .page {
            display: none;
            padding-bottom: 80px; /* –î–ª—è –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        }

        .page.active {
            display: block;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã */
        .cart-item {
            display: flex;
            padding: 16px;
            margin: 8px 16px;
            background: var(--tg-theme-secondary-bg-color);
            border-radius: 12px;
            align-items: center;
        }

        .cart-item-info {
            flex: 1;
            margin-left: 12px;
        }

        .cart-item-title {
            font-weight: 500;
            margin-bottom: 4px;
        }

        .cart-item-price {
            color: var(--tg-theme-button-color);
        }

        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .quantity-btn {
            width: 24px;
            height: 24px;
            border-radius: 12px;
            border: none;
            background: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            font-size: 16px;
            cursor: pointer;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è */
        .profile-header {
            padding: 24px 16px;
            text-align: center;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 40px;
            margin-bottom: 12px;
        }

        .profile-name {
            font-size: 20px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .profile-phone {
            color: var(--tg-theme-hint-color);
        }

        .profile-section {
            margin: 16px;
            padding: 16px;
            background: var(--tg-theme-secondary-bg-color);
            border-radius: 12px;
        }

        .profile-section-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 12px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π —Ç–æ–≤–∞—Ä–∞ */
        .product-details {
            padding: 16px;
        }

        .product-details-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 16px;
        }

        .product-details-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .product-details-description {
            color: var(--tg-theme-hint-color);
            margin-bottom: 16px;
            line-height: 1.5;
        }

        .product-details-price {
            font-size: 20px;
            font-weight: 600;
            color: var(--tg-theme-button-color);
            margin-bottom: 16px;
        }

        .add-to-cart-btn {
            width: 100%;
            padding: 16px;
            background: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <div id="home-page" class="page active">
        <div class="header">
            <input type="search" class="search-bar" placeholder="–ü–æ–∏—Å–∫ –∫–æ—Ñ–µ...">
        </div>

        <div class="categories">
            <div class="category active">–í—Å–µ</div>
            <div class="category">–≠—Å–ø—Ä–µ—Å—Å–æ</div>
            <div class="category">–ö–∞–ø—É—á–∏–Ω–æ</div>
            <div class="category">–õ–∞—Ç—Ç–µ</div>
            <div class="category">–§–∏–ª—å—Ç—Ä</div>
            <div class="category">–î–µ—Å–µ—Ä—Ç—ã</div>
        </div>

        <div class="loyalty-banner">
            <div>–í–∞—à–∏ –±–æ–Ω—É—Å–Ω—ã–µ –±–∞–ª–ª—ã</div>
            <div class="points">150</div>
            <div>–ü–æ–ª—É—á–∏—Ç–µ 10% –∫—ç—à–±—ç–∫–∞ —Å –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞</div>
        </div>

        <div class="products"></div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
    <div id="cart-page" class="page">
        <div class="header">
            <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
        </div>
        <div id="cart-items"></div>
        <div class="cart-total">
            <div>–ò—Ç–æ–≥–æ: <span id="cart-total-amount">0</span>‚ÇΩ</div>
            <button class="add-to-cart-btn" onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
    <div id="profile-page" class="page">
        <div class="profile-header">
            <img src="avatar.jpg" class="profile-avatar">
            <div class="profile-name">–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</div>
            <div class="profile-phone">+7 (999) 123-45-67</div>
        </div>

        <div class="profile-section">
            <div class="profile-section-title">–ë–æ–Ω—É—Å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</div>
            <div class="points">150 –±–∞–ª–ª–æ–≤</div>
            <div>–í–∞—à —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: –°–µ—Ä–µ–±—Ä—è–Ω—ã–π</div>
        </div>

        <div class="profile-section">
            <div class="profile-section-title">–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</div>
            <div id="order-history"></div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="bottom-nav">
        <a href="#" class="nav-item active" onclick="showPage('home')">
            <div class="nav-icon">üè†</div>
            <div class="nav-label">–ì–ª–∞–≤–Ω–∞—è</div>
        </a>
        <a href="#" class="nav-item" onclick="showPage('cart')">
            <div class="nav-icon">üõí</div>
            <div class="nav-label">–ö–æ—Ä–∑–∏–Ω–∞</div>
        </a>
        <a href="#" class="nav-item" onclick="showPage('profile')">
            <div class="nav-icon">üë§</div>
            <div class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</div>
        </a>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // –î–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö
        const products = [
            {
                id: 1,
                title: "–≠—Å–ø—Ä–µ—Å—Å–æ",
                description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏—Ç–∞–ª—å—è–Ω—Å–∫–∏–π —ç—Å–ø—Ä–µ—Å—Å–æ",
                price: 150,
                image: "espresso.jpg",
                category: "–≠—Å–ø—Ä–µ—Å—Å–æ"
            },
            {
                id: 2,
                title: "–ö–∞–ø—É—á–∏–Ω–æ",
                description: "–≠—Å–ø—Ä–µ—Å—Å–æ —Å –º–æ–ª–æ—á–Ω–æ–π –ø–µ–Ω–∫–æ–π",
                price: 200,
                image: "cappuccino.jpg",
                category: "–ö–∞–ø—É—á–∏–Ω–æ"
            },
            // –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ —Ç–æ–≤–∞—Ä–æ–≤
        ];

        // –ö–æ—Ä–∑–∏–Ω–∞
        let cart = [];

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
        function renderProducts(filteredProducts = products) {
            const container = document.querySelector('.products');
            container.innerHTML = filteredProducts.map(product => `
                <div class="product-card" onclick="showProduct(${product.id})">
                    <img src="${product.image}" class="product-image">
                    <div class="product-info">
                        <div class="product-title">${product.title}</div>
                        <div class="product-description">${product.description}</div>
                        <div class="product-price">${product.price}‚ÇΩ</div>
                    </div>
                </div>
            `).join('');
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã
        function renderCart() {
            const container = document.getElementById('cart-items');
            const totalElement = document.getElementById('cart-total-amount');
            let total = 0;

            container.innerHTML = cart.map(item => {
                total += item.price * item.quantity;
                return `
                    <div class="cart-item">
                        <img src="${item.image}" class="product-image" style="width: 60px; height: 60px;">
                        <div class="cart-item-info">
                            <div class="cart-item-title">${item.title}</div>
                            <div class="cart-item-price">${item.price}‚ÇΩ</div>
                        </div>
                        <div class="cart-item-controls">
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, ${item.quantity - 1})">-</button>
                            <span>${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, ${item.quantity + 1})">+</button>
                        </div>
                    </div>
                `;
            }).join('');

            totalElement.textContent = total;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω–µ
        function updateQuantity(productId, newQuantity) {
            if (newQuantity < 1) {
                cart = cart.filter(item => item.id !== productId);
            } else {
                const item = cart.find(item => item.id === productId);
                if (item) {
                    item.quantity = newQuantity;
                }
            }
            renderCart();
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É
        function addToCart(product) {
            const existingItem = cart.find(item => item.id === product.id);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            renderCart();
            showPage('cart');
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
        function checkout() {
            if (cart.length === 0) return;

            const order = {
                items: cart,
                total: cart.reduce((sum, item) => sum + item.price * item.quantity, 0),
                date: new Date(),
                status: 'pending'
            };

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram
            tg.sendData(JSON.stringify(order));
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(`${pageId}-page`).classList.add('active');

            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`.nav-item[onclick="showPage('${pageId}')"]`).classList.add('active');
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–∏—Å–∫–∞
        document.querySelector('.search-bar').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            const filtered = products.filter(p => 
                p.title.toLowerCase().includes(query) || 
                p.description.toLowerCase().includes(query)
            );
            renderProducts(filtered);
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        document.querySelectorAll('.category').forEach(category => {
            category.addEventListener('click', (e) => {
                document.querySelectorAll('.category').forEach(c => c.classList.remove('active'));
                e.target.classList.add('active');

                const categoryName = e.target.textContent;
                const filtered = categoryName === '–í—Å–µ' 
                    ? products 
                    : products.filter(p => p.category === categoryName);
                renderProducts(filtered);
            });
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        renderProducts();
        renderCart();
    </script>
</body>
</html>
